<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<title> Paca MAn</title>
	<style>
		*{ padding: 0; margin: 0; }
		canvas {background: #eee; display: block; margin: 0 auto; }
	</style>
</head>
<body>

<canvas id="myCanvas" width="600" height="800"></canvas>

<script>

var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");

var level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
     ];

var levVerLen = level.length;
var levHorzLen = level[0].length;

var brick = new Image();
var back = new Image();
var dot = new Image();
var wall = new Image();
var pacman = new Image();
var pacmaneat = new Image();
var power = new Image();
var powerone = new Image();
var dotpink = new Image();
var pacmanthrob = new Image();
var pacmaneatthrob = new Image();
var ghostpic = new Array();
ghostpic[0] = new Image();
ghostpic[1] = new Image();




brick.src = "brick.png";
back.src = "back.png";
dot.src = "dot.png";
wall.src = "wall.png";
pacman.src = "pac3.png";
pacmaneat.src = "pac4.png";
power.src = "power.png";
powerone.src = "power1.png";
dotpink.src = "dotpink.png";
pacmanthrob.src = "pac5.png";
pacmaneatthrob.src = "pac6.png";
ghostpic[0].src = "ghost1.png";
ghostpic[1].src = "ghost2.png";

var pacmanxpos = 320-96-32;
var pacmanypos = 320-64;
var pacmanan = 0;

var pacmanxmove = 0
var pacmanymove = 0


var rightPressed = false;
var leftPressed = false;
var upPressed = false;
var downPressed = false;

var dotsleft = 0;

var pacmanmoving = 0;

var pacspeed = 1;

var pacmanspeed=2;

var paclooper=0;

var special=0;

var specialtime=0;

var ghosts=null;

var ghostalllowedmove=2;

var bestlowestdots = 0;



document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);



function drawLevel() {


	dotsleft = 0;
	
			context.fillStyle = "green";
			context.fillRect(0, 0, canvas.width, canvas.height);
	
if (Number.isInteger(score/2)==true) {
			context.fillStyle = "purple";
			
			context.fillStyle = "green";
			context.fillRect(0, 0, canvas.width, canvas.height);
		context.font = "30px Arial";
			context.fillText(score, 580, 50);
}


	for (var v = 0; v < level.length; v++) {
		for (var h = 0; h < level[0].length; h++) {
			var xpos = h*32;
			var ypos = v*32;
			if (level[v][h] == 1) {
				context.drawImage(brick, xpos, ypos);	
			}
			if (level[v][h] == 2) {
				context.drawImage(back, xpos, ypos);	
			}
			if (level[v][h] == 3) {
				if (specialtime<1){
				context.drawImage(dot, xpos, ypos);
					dotsleft++;
					}
					
					if (specialtime>0){
					if (special==1){
					
					context.drawImage(dotpink, xpos, ypos);
					dotsleft++;
					special =2;
					
					}
					else if (special==2){
						if (Math.random()*100>49){
							
					context.drawImage(dotpink, xpos, ypos);
					dotsleft++;
						}
						else {
				context.drawImage(dot, xpos, ypos);
					dotsleft++;
						
						}
					}
					}
					
					
			}
			if (level[v][h] == 4) {
				context.drawImage(wall, xpos, ypos);	
			}
			if (level[v][h] == 5) {
				context.drawImage(power, xpos, ypos);	
				if (colorchange()==true){
				level[v][h] = 6;
				}
			}
			else if (level[v][h] == 6) {
				context.drawImage(powerone, xpos, ypos);	
				if (colorchange()==true){
				level[v][h] = 5;
				}
			}
			
		}
		
	}
	
	
			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText(score, 550, 300);

			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText("Score", 540, 260);

			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText(dotsleft, 550, 80);

			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText("Remain", 545, 40);


if  (dotsleft<bestlowestdots){
	bestlowestdots = dotsleft;
}


			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText(bestlowestdots, 550, 190);

			context.fillStyle = "white";
context.font = "30px Arial";
context.fillText("Best Dots left", 540, 150);



			context.fillStyle = "white";
context.font = "40px Arial";
context.fillText(pacmanspeed, 550, 780);


	var i;
	var z;
	var q;
	
		buttonpressed();
		collision(1);
		checkdot();
	
	
	
	if (pacmanmoving!==0){
	for (i=1; i < pacmanspeed; i++){
		buttonpressed();
		collision(1);
		checkdot();
		//console.log(pacsmove);
		if (pacmanmoving==0){
			break;
		}
		
		}
		}
		//console.log(ghostalllowedmove);
		
		if (ghosts!==null){
			
	for (q=0; q < pacmanspeed; q++){
				ghostalllowedmove++;
			for (i=0; i < ghosts.length; i++){
				if (Number.isInteger(ghostalllowedmove/2)==true || Number.isInteger(ghostalllowedmove/3)==true){
				if (ghosts[i][6]>0){
				
				if (Number.isInteger(ghosts[i][6]/2)==true){
				
					ghostmove(i);
				}
				}
					else{
					ghostmove(i);
					}
			checkghost(i);
			ghostdot(i);
			ghosts[i][6]--;
					z=ghostchosemove(i);
					if (Number.isInteger(ghosts[i][0]/32)==true && Number.isInteger(ghosts[i][1]/32)==true){
		//console.log(z.length);
					if (z.length>0){
						if (Math.random()*10<9){
							ghostnewdirection(i, 1);
							//console.log(z.length);
						}
					}
					}
					}
				}
			}
			}
		
		
		//console.log(Number.isInteger(ghostalllowedmove/2));
		//console.log(ghostalllowedmove/2);
		//console.log(ghostalllowedmove);
		
		if (ghosts!==null){
			
			for (i=0; i < ghosts.length; i++){
				ghostdraw(i);
				//ghostalllowedmove++;
			}
		
		}
		
		drawpacman();
		
		
	frame++;
	for (i=0; i < pacmanspeed; i++){
	specialtime--;
	}
	
	//console.log(specialtime);
	//console.log(Math.floor(Math.random()*5)-2);
	
	
}

function checkghost(m) {

	var z = 0;
	var zr = 0;
	var zl = 0;
	var q = 0;
	var qr = 0;
	var ql = 0;
	
	var px;
	var tx;

		z = (pacmanxpos)/32;
		z = Math.round(z);
		zr = (pacmanxpos)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos)/32;
		q = Math.round(q);
		qr = (pacmanypos)/32;
		qr = Math.ceil(qr);
		
		px=[q,z];
		
		
		z = (ghosts[m][0])/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1])/32;
		q = Math.round(q);
		qr = (ghosts[m][1])/32;
		qr = Math.ceil(qr);
		
		tx=[q,z];
		
		//console.log(tx);
		
		if (px[0] == tx[0] && px[1] == tx[1] && specialtime<0 && ghosts[m][6]<0){
		collision(-1);
			ghosts[m][6]=2;
		//console.log(px,tx);
			//level[q][z]=2;
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
	score--;
	return true;
		}
		
		if (px[0] == tx[0] && px[1] == tx[1] && specialtime>0){
			ghosts[m][6]=2000;
		//console.log(px,tx);
			//level[q][z]=2;
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
	return true;
		}
		
		//if (level[q][z]==5 || level[q][z]==6){
			//level[q][z]=2;
		//	special=1;
		//	specialtime=500;
		//	context.fillStyle = "blue";
		//	context.fillRect(0, 0, canvas.width, canvas.height);
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
		//	var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
   // snd.play();
	//score++;
	//	}

}

function ghostdot(m) {


if (ghosts[m][6]>0){
return false
}
	var z = 0;
	var zr = 0;
	var zl = 0;
	var q = 0;
	var qr = 0;
	var ql = 0;

		z = (ghosts[m][0])/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1])/32;
		q = Math.round(q);
		qr = (ghosts[m][1])/32;
		qr = Math.ceil(qr);
		
		if (level[q][z]==2 && Number.isInteger(ghosts[m][5]/78)==true && Math.random()*10<2){
			level[q][z]=3;
			
		//console.log(Number.isInteger(ghosts[m][5]/30));
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
		}
		
		if (Number.isInteger(ghosts[m][5]/133)==true && Math.random()*250<2){
			level[q][z]=5;
			
		//console.log(Number.isInteger(ghosts[m][5]/30));
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
		}
		
		ghosts[m][5]++;
		
		//if (level[q][z]==5 || level[q][z]==6){
		//	level[q][z]=2;
		//	special=1;
		//	specialtime=500;
		//	context.fillStyle = "blue";
		//	context.fillRect(0, 0, canvas.width, canvas.height);
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
		//	var snd = new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    //snd.play();
	//score++;
	//	}

}

function ghostmove(m){

	if (ghosts[m][2]==1) {
		z = (ghosts[m][0]+16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4){
			ghostnewdirection(m, 2);
			ghostmove(m);
		}
		else {
		ghosts[m][0] += pacspeed;
		}
		
	}
	else if (ghosts[m][2]==-1) {
	
		z = (ghosts[m][0]-16-pacspeed)/32; ////-17 cause we check one pixel over to see what is there, where he will be moving to
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4){
			ghostnewdirection(m, 2);
			ghostmove(m);
		}
		else {
		ghosts[m][0] -= pacspeed;
		}
		//console.log((pacmanypos-15)/32);
	}
	else if (ghosts[m][2]==2) {
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16-pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4){
			ghostnewdirection(m, 2);
			ghostmove(m);
		}
		else {
			ghosts[m][1] -= pacspeed;
		}
	}
	else if (ghosts[m][2]==-2) {
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]+16+pacspeed)/32;
		q = Math.round(q);
		
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4){
			ghostnewdirection(m, 2);
			ghostmove(m);
		}
		else {
		ghosts[m][1] += pacspeed;
		}
	}

}

function ghostchangedirection(m){

	var t;

		t= ghosts[m][2];
		
		
		while (Math.abs(ghosts[m][2])==Math.abs(t) || ghosts[m][2]==0){
	ghosts[m][2] = Math.floor(Math.random()*5)-2;
	if (ghosts[m][2]!==0){
		checkghostmove(m);
	}
	}

}

function ghostchosemove(m){

var i=[];
i=[];


if (Number.isInteger(ghosts[m][0]/32)==false && Number.isInteger(ghosts[m][1]/32)==false){

	return i=[0];
	}

		
		z = (ghosts[m][0]+16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4 || ghosts[m][2] ==1 || ghosts[m][2] ==-1){
			//
		}
		else {
			i.push(1);
		//ghosts[m][0] += pacspeed;
		}
		
	
		z = (ghosts[m][0]-16-pacspeed)/32; ////-17 cause we check one pixel over to see what is there, where he will be moving to
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4  || ghosts[m][2] ==-1 || ghosts[m][2] ==1){
			//i[1]=0;
		}
		else {
			i.push(-1);
		//ghosts[m][0] -= pacspeed;
		}
		//console.log((pacmanypos-15)/32);
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16-pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4  || ghosts[m][2] ==2 || ghosts[m][2] ==-2){
			//i[2]=0;
		}
		else {
			i.push(2);
			//ghosts[m][1] -= pacspeed;
		}
	
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]+16+pacspeed)/32;
		q = Math.round(q);
		
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4  || ghosts[m][2] ==-2 || ghosts[m][2] ==2){
			//i[3]=0;
		}
		else {
			i.push(-2);
		//ghosts[m][1] += pacspeed;
		}
		
		//console.log[i];
		
		return i;
		
		//console.log(i);
	

}

function ghostnewdirection(m, t){

var i=[];
 i=[];

		z = (ghosts[m][0]+16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4  || ghosts[m][2]==-1 || ghosts[m][2]==1){
			//i=0;
		}
		else {
			i.push(1);
			}
		//ghosts[m][0] += pacspeed;
		
		
	
		z = (ghosts[m][0]-16-pacspeed)/32; ////-17 cause we check one pixel over to see what is there, where he will be moving to
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4 || ghosts[m][2]==1 || ghosts[m][2]==-1){
			//i=0;
		}
		else {
			i.push(-1);
		//ghosts[m][0] -= pacspeed;
		}
		//console.log((pacmanypos-15)/32);
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16-pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4 || ghosts[m][2]==2|| ghosts[m][2]==-2){
			//i=0;
		}
		else {
			i.push(2);
			//ghosts[m][1] -= pacspeed;
		}
	
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]+16+pacspeed)/32;
		q = Math.round(q);
		
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4 || ghosts[m][2]==-2 || ghosts[m][2]==2){
			//i=0;
		}
		else {
			i.push(-2);
		//ghosts[m][1] += pacspeed;
		}
		
		//console.log(i);
		//console.log(i[(Math.floor(Math.random()*i.length))]);
		ghosts[m][2]=i[(Math.floor(Math.random()*i.length))];
		
	

}

function checkghostmove(m){

	if (ghosts[m][2]==1) {
		z = (ghosts[m][0]+16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4){
			ghosts[m][2]=0;
		}
		else {
		//ghosts[m][0] += pacspeed;
		}
		
	}
	else if (ghosts[m][2]==-1) {
	
		z = (ghosts[m][0]-16-pacspeed)/32; ////-17 cause we check one pixel over to see what is there, where he will be moving to
		z = Math.round(z);
		zr = (ghosts[m][0])/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16+pacspeed)/32;
		q = Math.round(q);
		qr = (ghosts[m][1]-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1 || level[q][z]==4 || level[qr][z]==4){
			ghosts[m][2]=0;
		}
		else {
		//ghosts[m][0] -= pacspeed;
		}
		//console.log((pacmanypos-15)/32);
	}
	else if (ghosts[m][2]==2) {
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]-16-pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4){
			ghosts[m][2]=0;
		}
		else {
			//ghosts[m][1] -= pacspeed;
		}
	}
	else if (ghosts[m][2]==-2) {
	
		z = (ghosts[m][0]-16+pacspeed)/32;
		z = Math.round(z);
		zr = (ghosts[m][0]-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (ghosts[m][1]+16+pacspeed)/32;
		q = Math.round(q);
		
		
		if (level[q][z]==1 || level[q][zr]==1 || level[q][z]==4 || level[q][zr]==4){
			ghosts[m][2]=0;
		}
		else {
		//ghosts[m][1] += pacspeed;
		}
	}

}

function ghostdraw(m){

if (ghosts[m][6]>0){
				
				if (Number.isInteger(ghosts[m][6]/3)==false){
				
		if (ghosts[m][4]<21){
		context.drawImage(ghostpic[ghosts[m][3]], ghosts[m][0], ghosts[m][1]);
				console.log("hey")
		}
		else if (ghosts[m][4]<41){
		context.drawImage(ghostpic[ghosts[m][3]+1], ghosts[m][0], ghosts[m][1]);
		}
		else{
		ghosts[m][4]=0;
		context.drawImage(ghostpic[ghosts[m][3]], ghosts[m][0], ghosts[m][1]);
		}
		
				}
			}
		else{
		if (ghosts[m][4]<21){
		context.drawImage(ghostpic[ghosts[m][3]], ghosts[m][0], ghosts[m][1]);
		}
		else if (ghosts[m][4]<41){
		context.drawImage(ghostpic[ghosts[m][3]+1], ghosts[m][0], ghosts[m][1]);
		}
		else{
		ghosts[m][4]=0;
		context.drawImage(ghostpic[ghosts[m][3]], ghosts[m][0], ghosts[m][1]);
		}
		}
		
		ghosts[m][4]++;


}


var colorchangeup=3;

function colorchange(){


colorchangeup++;


//console.log(colorchangeup);


if (colorchangeup>50){

if (Math.random()*100<10){
colorchangeup=0;
return true;
}

return false
}

}



		var frame=0;

function drawpacman() {

	if (pacmanmoving==0){
	if (specialtime>0){
			if (Math.random()*100>49){
							
		context.drawImage(pacmaneatthrob, pacmanxpos, pacmanypos);
						}
						else {
		context.drawImage(pacmaneat, pacmanxpos, pacmanypos);
						
						}
		}
		else{
		context.drawImage(pacmaneat, pacmanxpos, pacmanypos);
		}
		return false;
	}
	
	if (pacmanan < 20) {
	
		if (specialtime>0){
			if (Math.random()*100>49){
							
		context.drawImage(pacmanthrob, pacmanxpos, pacmanypos);
						}
						else {
		context.drawImage(pacman, pacmanxpos, pacmanypos);
						
						}
		}
		else{
		context.drawImage(pacman, pacmanxpos, pacmanypos);
		}
	}
	else if (pacmanan > 19) {
	
	if (specialtime>0){
			if (Math.random()*100>49){
							
		context.drawImage(pacmaneatthrob, pacmanxpos, pacmanypos);
						}
						else {
		context.drawImage(pacmaneat, pacmanxpos, pacmanypos);
						
						}
		}
		else{
		context.drawImage(pacmaneat, pacmanxpos, pacmanypos);
		}
		
	}
	if (pacmanan == 40) {
		context.drawImage(pacmaneat, pacmanxpos, pacmanypos);
		pacmanan = 0;
	}
	
		pacmanan++;

}

var score =-1;



function checkdot() {

	var z = 0;
	var zr = 0;
	var zl = 0;
	var q = 0;
	var qr = 0;
	var ql = 0;

		z = (pacmanxpos)/32;
		z = Math.round(z);
		zr = (pacmanxpos)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos)/32;
		q = Math.round(q);
		qr = (pacmanypos)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==3){
			level[q][z]=2;
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
	score++;
		}
		
		if (level[q][z]==5 || level[q][z]==6){
			level[q][z]=2;
			special=1;
			specialtime=1500;
			context.fillStyle = "blue";
			context.fillRect(0, 0, canvas.width, canvas.height);
			//context.drawImage(pacmaneat, pacmanxpos-16, pacmanypos);
			//context.drawImage(pacmaneat, pacmanxpos-32, pacmanypos+32);
			//context.drawImage(pacmaneat, pacmanxpos-48, pacmanypos-32);
			//context.drawImage(pacmaneat, pacmanxpos-64, pacmanypos-16);
			var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");  
    snd.play();
	score++;
		}

}


function collision(m) {



	var z = 0;
	var zr = 0;
	var zl = 0;
	var q = 0;
	var qr = 0;
	var ql = 0;
	

	

	if (pacmanmoving==1) {
		z = (pacmanxpos+16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1){
			pacmanmoving=0;
		}
		else if (level[q][z]==4){
			pacmanmoving=0;
		}
		else if (level[qr][z]==4){
			pacmanmoving=0;
		}
		else {
		pacmanxpos += pacspeed*m;
		}
		
		//change.log();
	}
	else if (pacmanmoving==2) {
	
		z = (pacmanxpos-16-pacspeed)/32; ////-17 cause we check one pixel over to see what is there, where he will be moving to
		z = Math.round(z);
		zr = (pacmanxpos)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1){
			pacmanmoving=0;
		}
		else if (level[q][z]==4){
			pacmanmoving=0;
		}
		else if (level[qr][z]==4){
			pacmanmoving=0;
		}
		else {
		pacmanxpos -= pacspeed*m;
		}
		//console.log((pacmanypos-15)/32);
	}
	else if (pacmanmoving==3) {
	
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16-pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1){
			pacmanmoving=0;
		}
		else if (level[q][z]==4){
			pacmanmoving=0;
		}
		else if (level[q][zr]==4){
			pacmanmoving=0;
		}
		else {
			pacmanypos -= pacspeed*m;
		}
	}
	else if (pacmanmoving==4) {
	
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos+16+pacspeed)/32;
		q = Math.round(q);
		
		//console.log(level[q][z]);
		//console.log(level[q][zr]);
		
		if (level[q][z]==1 || level[q][zr]==1){
			pacmanmoving=0;
		}
		else if (level[q][z]==4){
			pacmanmoving=0;
		}
		else if (level[q][zr]==4){
			pacmanmoving=0;
		}
		else {
		pacmanypos += pacspeed*m;
		}
	}
	
	//console.log(restart);
	//console.log(pacmanxpos);
	//console.log(z);
	//console.log(z);
	//console.log(zl);
	//console.log(q);
	//console.log(ql);
	//console.log(qr);
}

function restartlev(l) {

if (l==1) {
 level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
     ];
 pacmanxpos = 320-96-32;
 pacmanypos = 320-64;
	 }
else if (l==2) {
 level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
        [1, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 4, 3, 1,1,1,3,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 4, 3, 3, 3, 3, 4, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 4, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 4, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 1,1,1,3,1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1,1,1,3,1],
        [1, 3, 3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 1,1,1,3,1],
		[1, 3, 4, 3, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,3,1],
		[1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1],
     ];
 pacmanxpos = 32;
 pacmanypos = 32;
	 }
	 else if (l==3) {
 level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
     ];
 pacmanxpos = 320-96-32;
 pacmanypos = 320-64;
	 }
else if (l==4) {
 level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 3, 3, 4,4,4,3,1],
        [1, 3, 4, 4, 3, 3, 3, 4, 3, 4, 3, 4, 4, 4,3,3,3,1],
        [1, 3, 3, 3, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4,3,4,3,1],
        [1, 3, 4, 3, 3, 3, 3, 4, 3, 3, 3, 3, 3, 3,3,4,3,1],
        [1, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 4,4,4,3,1],
        [1, 3, 4, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4,4,4,3,1],
        [1, 3, 4, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
        [1, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 4,4,4,3,1],
        [1, 3, 3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
		[1, 3, 4, 3, 4, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3,3,3,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3,3,3,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3,3,3,3,1],
		[1, 3, 4, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 4,4,4,3,1],
		[1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1],
     ];
 pacmanxpos = 32;
 pacmanypos = 32;
	 }
	 else if (l==5) {
 level=[
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 5, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 5, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,3,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
        [1, 3, 4, 4, 4, 4, 3, 4, 3, 4, 3, 4, 3, 4,4,4,5,1,1],
        [1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3,3,3,1,1],
		[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1,1,1,1,1],
     ];
	 for (var v = 0; v < level.length; v++) {
		for (var h = 0; h < level[0].length; h++) {
			if (level[v][h] == 3) {
					bestlowestdots++;
				}
			}
		}
		
 pacmanxpos = 32;
 pacmanypos = 32;
 
 ghosts = [[320, 288, 1, 0, 0, Math.floor(Math.random()*1000), 0], // xpos, ypos, direction, color, animation, dotdrop, hurt
		  [320, 320, 1, 0, 15, Math.floor(Math.random()*1000), 0],
		  [64, 64, 1, 0, 30, Math.floor(Math.random()*1000), 0],
		  [320, 320, 1, 0, 45, Math.floor(Math.random()*1000), 0],
		  ];
		  
	 }
}


	var buttonintervals = 1113;

function buttonpressed(){

	m=0; 
	
	//console.log(buttonintervals);
	
	if (buttonintervals<(30*pacmanspeed)){
	
	if (pacsmove==1){
		z = (pacmanxpos+16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1 || level[qr][z]==1){
			//return false;
		}
		else if (level[q][z]==4){
			//return false;
		}
		else if (level[qr][z]==4){
			//return false;
		}
		else {
			pacmanmoving=1;
		}
		}
		
		if (pacsmove==2){
		z = (pacmanxpos-16-pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos+pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		
		//console.log(pacsmove);
		
		
		if (level[q][z]==1 || level[qr][z]==1){
			//pacmanmoving=0;
		}
		else if (level[q][z]==4){
			//pacmanmoving=0;
		}
		else if (level[qr][z]==4){
			//pacmanmoving=0;
		}
		else {
			pacmanmoving=2;
		}
		}
		
		
		if (pacsmove==3){
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16-pacspeed)/32;
		q = Math.round(q);
		
		//console.log(pacmanmoving);
		
		if (level[q][z]==1 || level[q][zr]==1){
			//return false;
		}
		else if (level[q][z]==4){
			//return false;
		}
		else if (level[q][zr]==4){
			//return false;
		}
		else {
			pacmanmoving=3;
		}
		}

		if (pacsmove==4){
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos+16+pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1 || level[q][zr]==1){
			//return false;
		}
		else if (level[q][z]==4){
			//return false;
		}
		else if (level[q][zr]==4){
			//return false;
		}
		else {
			pacmanmoving=4;
		}
		}
		buttonintervals++;
		
		}
	

}

function checkcollision(m){


		if (m==1){
		z = (pacmanxpos+16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		if (level[q][z]==1){
			return false;
		}
		else if (level[q][z]==4){
			return false;
		}
		else if (level[qr][z]==4){
			return false;
		}
		else {
		return true;
		}
		}
		
		if (m==2){
		z = (pacmanxpos-16-pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16+pacspeed)/32;
		q = Math.round(q);
		qr = (pacmanypos-pacspeed)/32;
		qr = Math.ceil(qr);
		
		//console.log(pacmanypos);
		
		
		if (level[q][z]==1){
			return false;
		}
		else if (level[q][z]==4){
			return false;
		}
		else if (level[qr][z]==4){
			return false;
		}
		else {
			return true;
		}
		}
		
		
		if (m==3){
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos-pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos-16-pacspeed)/32;
		q = Math.round(q);
		
		console.log(pacmanmoving);
		
		if (level[q][z]==1){
			return false;
		}
		else if (level[q][z]==4){
			return false;
		}
		else if (level[q][zr]==4){
			return false;
		}
		else {
		return true;
		}
		}

		if (m==4){
		z = (pacmanxpos-16+pacspeed)/32;
		z = Math.round(z);
		zr = (pacmanxpos+pacspeed)/32;
		zr = Math.ceil(zr);
		q = (pacmanypos+16+pacspeed)/32;
		q = Math.round(q);
		
		if (level[q][z]==1){
			return false;
		}
		else if (level[q][z]==4){
			return false;
		}
		else if (level[q][zr]==4){
			return false;
		}
		else {
			return true;
		}
		}
		}
		



function keyDownHandler(e){
	if (e.keyCode == 39 || e.keyCode == 68){
		pacsmove=1;
		buttonintervals=0;
	}
	else if (e.keyCode == 37 || e.keyCode == 65){
		pacsmove=2;
		buttonintervals=0;
	}
	else if (e.keyCode == 38 || e.keyCode == 87){
		pacsmove=3;
		buttonintervals=0;
	}
	else if (e.keyCode == 40 || e.keyCode == 83){
		pacsmove=4;
		buttonintervals=0;
	}
	else if (e.keyCode == 49){
		restartlev(1);
	}
	else if (e.keyCode == 50){
		restartlev(2);
	}
	else if (e.keyCode == 51){
		restartlev(3);
	}
	else if (e.keyCode == 52){
		restartlev(4);
	}
	else if (e.keyCode == 107){
		pacmanspeed += 1;
		Math.trunc(pacspeed);
	}
	else if (e.keyCode == 109){
		pacmanspeed -= 1;
	}
	if (e.keyCode == 53){
		restartlev(5);
	}
}

function keyUpHandler(e){
	if (e.keyCode == 39){
		rightPressed = false;
	}
	else if (e.keyCode == 37){
		leftPressed = false;
	}
	else if (e.keyCode == 38){
		upPressed = false;
	}
	else if (e.keyCode == 40){
		downPressed = false;
	}
	else if (e.keyCode == 68){
		rightPressed = false;
	}
	else if (e.keyCode == 65){
		leftPressed = false;
	}
	else if (e.keyCode == 87){
		upPressed = false;
	}
	else if (e.keyCode == 83){
		downPressed = false;
	}
}

setInterval(drawLevel, 16);

debugger;


</script>

</body>
</html>